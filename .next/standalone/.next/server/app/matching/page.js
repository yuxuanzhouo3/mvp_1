(()=>{var e={};e.id=4849,e.ids=[4849],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},44374:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>o});var r=s(67096),a=s(16132),l=s(37284),i=s.n(l),n=s(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let o=["",{children:["matching",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,81561)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3102)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,38196)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,44293)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/not-found.tsx"]}],d=["/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/page.tsx"],x="/matching/page",m={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/matching/page",pathname:"/matching",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},84699:(e,t,s)=>{Promise.resolve().then(s.bind(s,56436))},56436:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var r=s(53854),a=s(34218),l=s(51018),i=s(86665),n=s(31974),c=s(2882),o=s(10518),d=s(88640),x=s(49425),m=s(67510),h=s(85096),u=s(89398),p=s(38954),g=s(74920);function y(){let{user:e,signOut:t,loading:s}=(0,i.a)(),y=(0,l.useRouter)(),{toast:b}=(0,n.p)(),[f,j]=(0,a.useState)([]),[v,N]=(0,a.useState)(0),[w,_]=(0,a.useState)(!0),[k,Z]=(0,a.useState)(!1),q=async()=>{if(e?.id)try{_(!0);let e=await fetch("/api/matching/candidates");if(e.ok){let t=await e.json();j(t)}else b({title:"加载失败",description:"无法加载匹配候选人",variant:"destructive"})}catch(e){b({title:"加载失败",description:"网络错误，请稍后重试",variant:"destructive"})}finally{_(!1)}};(0,a.useEffect)(()=>{if(!s){if(!e||!e.id){y.push("/auth/login");return}q()}},[e,s]);let C=async()=>{try{await t(),window.location.href="/auth/login",b({title:"已退出登录",description:"期待您的再次光临！"})}catch(e){b({title:"退出失败",description:"请稍后重试",variant:"destructive"})}},P=async()=>{if(v>=f.length)return;let e=f[v];try{let t=await fetch("/api/matching/like",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({candidate_id:e.id})});t.ok&&b({title:"喜欢成功",description:`你已喜欢 ${e.full_name}`})}catch(e){}N(e=>e+1)};if(w||s)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"加载中..."})]})});let G=f[v];return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)("button",{onClick:()=>{y.push("/dashboard")},className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[r.jsx(c.Z,{className:"h-5 w-5 mr-2"}),"返回"]}),r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"匹配"}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:e?.user_metadata?.full_name?.charAt(0).toUpperCase()||"U"}),r.jsx("span",{className:"text-sm font-medium text-gray-700 hidden sm:block",children:e?.user_metadata?.full_name||"User"})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("button",{className:"flex items-center space-x-1 text-gray-600 hover:text-gray-900 transition-colors",children:r.jsx(o.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 hidden group-hover:block",children:[r.jsx("button",{onClick:()=>y.push("/dashboard/settings"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"设置"}),r.jsx("hr",{className:"my-1"}),r.jsx("button",{onClick:C,className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:"退出登录"})]})]})]})]})})}),(0,r.jsxs)("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out ${k?"translate-x-0":"-translate-x-full"}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"PersonaLink"}),r.jsx("button",{onClick:()=>Z(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(c.Z,{className:"h-5 w-5"})})]}),r.jsx("nav",{className:"mt-4",children:(0,r.jsxs)("div",{className:"px-4 space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>{y.push("/dashboard"),Z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(d.Z,{className:"mr-3 h-5 w-5"}),"首页"]}),(0,r.jsxs)("button",{onClick:()=>{y.push("/chat"),Z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(x.Z,{className:"mr-3 h-5 w-5"}),"聊天"]}),(0,r.jsxs)("button",{onClick:()=>{y.push("/matching"),Z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-blue-600 rounded-md bg-blue-50",children:[r.jsx(m.Z,{className:"mr-3 h-5 w-5"}),"匹配"]}),(0,r.jsxs)("button",{onClick:()=>{y.push("/payment/recharge"),Z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(h.Z,{className:"mr-3 h-5 w-5"}),"充值"]}),(0,r.jsxs)("button",{onClick:()=>{y.push("/dashboard/settings"),Z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(o.Z,{className:"mr-3 h-5 w-5"}),"设置"]})]})})]}),k&&r.jsx("div",{className:"fixed inset-0 z-30 bg-black bg-opacity-50",onClick:()=>Z(!1)}),r.jsx("div",{className:"pt-16",children:r.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:0===f.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(m.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"暂时没有更多候选人"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"请稍后再来查看新的匹配！"}),r.jsx("button",{onClick:()=>y.push("/dashboard"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"返回首页"})]}):v>=f.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(m.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"已查看所有候选人"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"请稍后再来查看新的匹配！"}),r.jsx("button",{onClick:()=>y.push("/dashboard"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"返回首页"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[v+1," / ",f.length]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"w-full h-64 bg-gradient-to-br from-blue-400 to-purple-600 flex items-center justify-center",children:r.jsx("div",{className:"w-32 h-32 bg-white rounded-full flex items-center justify-center text-4xl font-bold text-gray-700",children:G.full_name?.charAt(0).toUpperCase()})}),r.jsx("div",{className:"absolute top-4 right-4 bg-white rounded-full px-3 py-1 shadow-md",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(u.Z,{className:"h-4 w-4 text-yellow-500 mr-1"}),(0,r.jsxs)("span",{className:"text-sm font-semibold text-gray-700",children:[G.compatibility_score,"%"]})]})})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:G.full_name}),G.age&&(0,r.jsxs)("span",{className:"text-lg text-gray-600",children:[G.age,"岁"]})]}),G.location&&(0,r.jsxs)("div",{className:"flex items-center text-gray-600 mb-4",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-2"}),G.location]}),G.bio&&r.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:G.bio}),G.interests&&G.interests.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"兴趣爱好"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:G.interests.map((e,t)=>r.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:e},t))})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("button",{onClick:()=>{N(e=>e+1)},className:"flex-1 flex items-center justify-center px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[r.jsx(g.Z,{className:"h-5 w-5 mr-2"}),"跳过"]}),(0,r.jsxs)("button",{onClick:P,className:"flex-1 flex items-center justify-center px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[r.jsx(m.Z,{className:"h-5 w-5 mr-2"}),"喜欢"]})]})]})]})]})})})]})}},31974:(e,t,s)=>{"use strict";s.d(t,{p:()=>a});var r=s(70664);let a=r.pm},2882:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},85096:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},38954:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},49425:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},89398:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},81561:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>c});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/page.tsx`),{__esModule:l,$$typeof:i}=a,n=a.default,c=n}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3271,5359,7583],()=>s(44374));module.exports=r})();