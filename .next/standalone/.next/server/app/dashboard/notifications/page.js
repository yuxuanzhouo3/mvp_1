(()=>{var e={};e.id=1258,e.ids=[1258],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},25380:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>o});var r=s(67096),a=s(16132),i=s(37284),n=s.n(i),c=s(32564),l={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>c[e]);s.d(t,l);let o=["",{children:["dashboard",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,34589)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/notifications/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,15581)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,3102)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,38196)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,44293)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/not-found.tsx"]}],d=["/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/notifications/page.tsx"],x="/dashboard/notifications/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/notifications/page",pathname:"/dashboard/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},31381:(e,t,s)=>{Promise.resolve().then(s.bind(s,261))},261:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(53854),a=s(34218),i=s(51018),n=s(86665),c=s(63165),l=s(7857),o=s(26115),d=s(11273),x=s(31974),m=s(67510),u=s(49425),p=s(89471),h=s(66802),g=s(2882),j=s(75548),v=s.n(j);function f(){let e=(0,i.useRouter)(),{user:t}=(0,n.a)(),{toast:s}=(0,x.p)(),[j,f]=(0,a.useState)([]),[b,y]=(0,a.useState)(!0),[_,N]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(!t){e.push("/auth/login");return}w()},[t]);let w=async()=>{try{y(!0);let e=await fetch("/api/user/notifications");if(e.ok){let t=await e.json();f(t.notifications),N(t.notifications.filter(e=>!e.is_read).length)}}catch(e){s({title:"加载失败",description:"无法加载通知",variant:"destructive"})}finally{y(!1)}},k=async e=>{try{let t=await fetch(`/api/user/notifications/${e}/read`,{method:"PUT"});t.ok&&(f(t=>t.map(t=>t.id===e?{...t,is_read:!0}:t)),N(e=>Math.max(0,e-1)))}catch(e){s({title:"操作失败",description:"无法标记为已读",variant:"destructive"})}},q=async()=>{try{let e=await fetch("/api/user/notifications/read-all",{method:"PUT"});e.ok&&(f(e=>e.map(e=>({...e,is_read:!0}))),N(0),s({title:"已全部标记为已读"}))}catch(e){s({title:"操作失败",description:"无法标记全部为已读",variant:"destructive"})}},P=t=>{t.is_read||k(t.id),t.action_url&&e.push(t.action_url)},C=e=>{switch(e){case"match":return r.jsx(m.Z,{className:"h-5 w-5 text-red-500"});case"message":return r.jsx(u.Z,{className:"h-5 w-5 text-blue-500"});case"payment":return r.jsx(p.Z,{className:"h-5 w-5 text-green-500"});default:return r.jsx(p.Z,{className:"h-5 w-5 text-gray-500"})}},Z=e=>{switch(e){case"match":return r.jsx(o.C,{variant:"destructive",className:"bg-red-100 text-red-800",children:"匹配"});case"message":return r.jsx(o.C,{variant:"default",className:"bg-blue-100 text-blue-800",children:"消息"});case"payment":return r.jsx(o.C,{variant:"default",className:"bg-green-100 text-green-800",children:"支付"});default:return r.jsx(o.C,{variant:"secondary",children:"系统"})}},G=e=>{let t=new Date(e),s=new Date,r=(s.getTime()-t.getTime())/36e5;return r<1?"刚刚":r<24?`${Math.floor(r)}小时前`:r<168?`${Math.floor(r/24)}天前`:t.toLocaleDateString("zh-CN")};return b?r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"加载通知中..."})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"通知中心"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"查看您的所有通知和消息"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[_>0&&(0,r.jsxs)(l.z,{variant:"outline",onClick:q,children:[r.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"全部已读"]}),r.jsx(v(),{href:"/dashboard",children:(0,r.jsxs)(l.z,{variant:"outline",children:[r.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"返回仪表盘"]})})]})]}),r.jsx("div",{className:"space-y-4",children:0===j.length?r.jsx(c.Zb,{children:(0,r.jsxs)(c.aY,{className:"text-center py-12",children:[r.jsx(p.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"暂无通知"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"当有新消息、匹配或其他重要事件时，您会在这里看到通知"})]})}):j.map(e=>r.jsx(c.Zb,{className:`cursor-pointer transition-all hover:shadow-md ${e.is_read?"":"border-blue-200 bg-blue-50 dark:bg-blue-900/20"}`,onClick:()=>P(e),children:r.jsx(c.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:"flex-shrink-0 mt-1",children:C(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),Z(e.type),!e.is_read&&r.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-sm text-gray-500",children:G(e.created_at)}),!e.is_read&&r.jsx(l.z,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),k(e.id)},children:r.jsx(h.Z,{className:"h-4 w-4"})})]})]}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:e.message}),e.sender&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,r.jsxs)(d.qE,{className:"h-6 w-6",children:[r.jsx(d.F$,{src:e.sender.avatar_url}),r.jsx(d.Q5,{children:e.sender.name.charAt(0).toUpperCase()})]}),r.jsx("span",{className:"text-sm text-gray-500",children:e.sender.name})]})]})]})})},e.id))})]})})}},66802:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},34589:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/notifications/page.tsx`),{__esModule:i,$$typeof:n}=a,c=a.default,l=c}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3271,5359,7583,9864],()=>s(25380));module.exports=r})();