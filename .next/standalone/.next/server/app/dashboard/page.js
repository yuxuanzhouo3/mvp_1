(()=>{var e={};e.id=7702,e.ids=[7702],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},40243:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d});var r=t(67096),a=t(16132),l=t(37284),i=t.n(l),n=t(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1618)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,15581)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,3102)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,38196)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/not-found.tsx"]}],o=["/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/page.tsx"],x="/dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},60516:(e,s,t)=>{Promise.resolve().then(t.bind(t,58441))},58441:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(53854),a=t(34218),l=t(51018),i=t(86665),n=t(31974),c=t(42833),d=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,d.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var x=t(10518),m=t(2882),h=t(88640),u=t(49425),p=t(67510),g=t(85096),b=t(41871),j=t(38954),y=t(14024);function f(){let{user:e,signOut:s,loading:t}=(0,i.a)(),d=(0,l.useRouter)(),f=(0,l.usePathname)(),{toast:v}=(0,n.p)(),N=(0,c.eI)("https://bamratexknmqvdbalzen.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhbXJhdGV4a25tcXZkYmFsemVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1MTM4NzEsImV4cCI6MjA2ODA4OTg3MX0.yYa98ioJLLouUgHWITGb7U_VjNCTUuM-5NcraM7f3zA"),[w,k]=(0,a.useState)(null),[_,C]=(0,a.useState)([]),[Z,q]=(0,a.useState)(null),[P,M]=(0,a.useState)(!0),[I,U]=(0,a.useState)(!1),[G,z]=(0,a.useState)(!1),A=async()=>{if(e?.id)try{M(!0);let{data:{session:e}}=await N.auth.getSession(),s=e?.access_token;if(!s)return;let t={Authorization:`Bearer ${s}`,"Content-Type":"application/json"},r=await fetch("/api/user/profile",{headers:t});if(r.ok){let e=await r.json();k(e.profile)}let a=await fetch("/api/user/matches",{headers:t});if(a.ok){let e=await a.json();C(e.matches?.slice(0,5)||[])}let l=await fetch("/api/user/stats",{headers:t});if(l.ok){let e=await l.json();q(e.stats)}}catch(e){}finally{M(!1)}};if((0,a.useEffect)(()=>{if(!t){if(U(!0),e&&e.id)A();else{k(null),C([]),q(null),M(!1),d.push("/auth/login");return}}},[e,t,I]),P||t)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"加载中..."})]})});if(!w)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md text-center max-w-md",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"无法加载用户资料"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"请稍后重试或联系客服。"}),r.jsx("button",{onClick:()=>window.location.reload(),className:"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-md transition-colors",children:"刷新页面"})]})});let J=async()=>{try{await s(),window.location.href="/auth/login",v({title:"已退出登录",description:"期待您的再次光临！"})}catch(e){v({title:"退出失败",description:"请稍后重试",variant:"destructive"})}},S="/dashboard/settings"===f;return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[!S&&r.jsx("header",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[r.jsx("button",{onClick:()=>z(!G),className:"absolute left-2 top-1/2 transform -translate-y-1/2 z-50 p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors",style:{left:"1%"},children:r.jsx(o,{className:"h-5 w-5"})}),r.jsx("div",{className:"flex-1 flex justify-center",children:r.jsx("h1",{className:"text-xl font-bold text-blue-600",children:"PersonaLink"})}),r.jsx("div",{className:"relative",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:w.full_name?.charAt(0).toUpperCase()}),r.jsx("span",{className:"text-sm font-medium text-gray-700 hidden sm:block",children:w.full_name})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("button",{className:"flex items-center space-x-1 text-gray-600 hover:text-gray-900 transition-colors",children:r.jsx(x.Z,{className:"h-4 w-4"})}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 hidden group-hover:block",children:[r.jsx("button",{onClick:()=>d.push("/dashboard/settings"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"设置"}),r.jsx("button",{onClick:()=>d.push("/dashboard/notifications"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"通知"}),r.jsx("hr",{className:"my-1"}),r.jsx("button",{onClick:J,className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:"退出登录"})]})]})]})})]})})}),(0,r.jsxs)("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out ${G?"translate-x-0":"-translate-x-full"}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"PersonaLink"}),r.jsx("button",{onClick:()=>z(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(m.Z,{className:"h-5 w-5"})})]}),r.jsx("nav",{className:"mt-4",children:(0,r.jsxs)("div",{className:"px-4 space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>{d.push("/dashboard"),z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(h.Z,{className:"mr-3 h-5 w-5"}),"首页"]}),(0,r.jsxs)("button",{onClick:()=>{d.push("/chat"),z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(u.Z,{className:"mr-3 h-5 w-5"}),"聊天"]}),(0,r.jsxs)("button",{onClick:()=>{d.push("/matching"),z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(p.Z,{className:"mr-3 h-5 w-5"}),"匹配"]}),(0,r.jsxs)("button",{onClick:()=>{d.push("/payment/recharge"),z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(g.Z,{className:"mr-3 h-5 w-5"}),"充值"]}),(0,r.jsxs)("button",{onClick:()=>{d.push("/dashboard/settings"),z(!1)},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900",children:[r.jsx(x.Z,{className:"mr-3 h-5 w-5"}),"设置"]})]})})]}),G&&r.jsx("div",{className:"fixed inset-0 z-30 bg-black bg-opacity-50",onClick:()=>z(!1)}),r.jsx("div",{className:`${S?"":"pt-16"} transition-all duration-300`,children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-blue-600 mb-2",children:["欢迎回来，",w.full_name,"！"]}),r.jsx("p",{className:"text-gray-600",children:"发现新的朋友，开始有趣的对话"})]})}),r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"快速操作"})}),r.jsx("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>{d.push("/matching")},className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(p.Z,{className:"mr-2 h-5 w-5"}),"开始匹配"]}),(0,r.jsxs)("button",{onClick:()=>{d.push("/chat")},className:"flex items-center justify-center px-4 py-3 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[r.jsx(u.Z,{className:"mr-2 h-5 w-5"}),"查看聊天"]})]})})]})}),Z&&r.jsx("div",{className:"mb-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"数据统计"})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Z.totalMatches}),r.jsx("div",{className:"text-sm text-gray-600",children:"总匹配数"})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:Z.totalMessages}),r.jsx("div",{className:"text-sm text-gray-600",children:"消息数量"})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:Z.activeChats}),r.jsx("div",{className:"text-sm text-gray-600",children:"活跃聊天"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-yellow-600",children:[Z.profileCompletion,"%"]}),r.jsx("div",{className:"text-sm text-gray-600",children:"资料完整度"})]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-yellow-500 h-2 rounded-full transition-all duration-300",style:{width:`${Z.profileCompletion}%`}})})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[r.jsx(b.Z,{className:"mr-2 h-5 w-5"}),"个人资料"]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white text-lg font-semibold mr-4",children:w.full_name?.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:w.full_name}),r.jsx("p",{className:"text-sm text-gray-600",children:w.email})]})]}),w.location&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-3 flex items-center",children:[r.jsx(j.Z,{className:"mr-1 h-4 w-4"}),w.location]}),w.interests&&w.interests.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"兴趣爱好"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[w.interests.slice(0,3).map((e,s)=>r.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:e},s)),w.interests.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:["+",w.interests.length-3]})]})]}),r.jsx("button",{onClick:()=>d.push("/profile/edit"),className:"w-full px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:"编辑资料"})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[r.jsx(g.Z,{className:"mr-2 h-5 w-5"}),"积分余额"]})}),(0,r.jsxs)("div",{className:"p-6 text-center",children:[r.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:w.credits}),r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"可用积分"}),(0,r.jsxs)("button",{onClick:()=>{d.push("/payment/recharge")},className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center",children:[r.jsx(y.Z,{className:"mr-2 h-5 w-5"}),"充值积分"]})]})]})]}),_.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[r.jsx(p.Z,{className:"mr-2 h-5 w-5"}),"最近匹配"]}),r.jsx("button",{onClick:()=>d.push("/matching/history"),className:"text-sm text-blue-600 hover:text-blue-700",children:"查看全部"})]}),r.jsx("div",{className:"divide-y divide-gray-200",children:_.map(e=>r.jsx("div",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center text-white text-sm font-semibold mr-3",children:e.matched_user.full_name?.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-semibold text-gray-900",children:e.matched_user.full_name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["匹配度: ",e.compatibility_score,"%"]})]})]}),r.jsx("button",{onClick:()=>d.push(`/chat/${e.id}`),className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:"聊天"})]})},e.id))})]})]})})]})}},38954:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},14024:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},41871:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},1618:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>c});var r=t(95153);let a=(0,r.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/page.tsx`),{__esModule:l,$$typeof:i}=a,n=a.default,c=n}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[3271,5359,7583,9864],()=>t(40243));module.exports=r})();