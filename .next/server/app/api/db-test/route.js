(()=>{var e={};e.id=8816,e.ids=[8816,8181],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},92680:(e,t,s)=>{"use strict";s.r(t),s.d(t,{headerHooks:()=>h,originalPathname:()=>b,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>p,serverHooks:()=>d,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>w});var r={};s.r(r),s.d(r,{GET:()=>u,POST:()=>m});var o=s(10884),n=s(16132),a=s(21040),i=s(95798),c=s(69978);class l{static{this.errorLog=[]}static logError(e,t){this.errorLog.push({timestamp:new Date().toISOString(),error:e instanceof Error?e.message:String(e),context:t})}static getErrorLog(){return this.errorLog}static clearErrorLog(){this.errorLog=[]}static createErrorResponse(e,t){return this.logError(e,t),i.Z.json({status:"error",error:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()},{status:500})}}async function u(e){let t=Date.now();try{let e=(0,c.e)(),s={timestamp:new Date().toISOString(),environment:"production",tests:{basicConnection:{},tableAccess:{},performance:{},concurrentConnections:{},rlsPolicies:{},environmentVariables:{},errorLog:[]}},r=Date.now();try{let{data:t,error:o}=await e.from("profiles").select("count").limit(1);s.tests.basicConnection={status:o?"failed":"success",responseTime:Date.now()-r,error:o?.message||null}}catch(e){s.tests.basicConnection={status:"failed",responseTime:Date.now()-r,error:e instanceof Error?e.message:"Unknown error"}}for(let t of(s.tests.tableAccess={},["profiles","matches","chats","messages","user_settings","user_activity"])){let r=Date.now();try{let{data:o,error:n}=await e.from(t).select("*").limit(1);s.tests.tableAccess[t]={status:n?"failed":"success",responseTime:Date.now()-r,error:n?.message||null}}catch(e){s.tests.tableAccess[t]={status:"failed",responseTime:Date.now()-r,error:e instanceof Error?e.message:"Unknown error"}}}for(let t of(s.tests.performance={},[{name:"simple_select",query:()=>e.from("profiles").select("id, full_name").limit(10)},{name:"complex_select",query:()=>e.from("profiles").select("*").limit(5)},{name:"count_query",query:()=>e.from("profiles").select("count")},{name:"filtered_query",query:()=>e.from("profiles").select("*").limit(5)}])){let e=Date.now();try{let{data:r,error:o}=await t.query();s.tests.performance[t.name]={status:o?"failed":"success",responseTime:Date.now()-e,resultCount:Array.isArray(r)?r.length:1,error:o?.message||null}}catch(r){s.tests.performance[t.name]={status:"failed",responseTime:Date.now()-e,error:r instanceof Error?r.message:"Unknown error"}}}let o=[,,,,,].fill(null).map(async(t,s)=>{let r=Date.now();try{let{data:t,error:o}=await e.from("profiles").select("count").limit(1);return{index:s,success:!o,responseTime:Date.now()-r,error:o?.message||null}}catch(e){return{index:s,success:!1,responseTime:Date.now()-r,error:e instanceof Error?e.message:"Unknown error"}}}),n=await Promise.all(o);s.tests.concurrentConnections={total:n.length,successful:n.filter(e=>e.success).length,failed:n.filter(e=>!e.success).length,averageResponseTime:n.reduce((e,t)=>e+t.responseTime,0)/n.length,details:n};let a=Date.now();try{let{data:t,error:r}=await e.from("profiles").select("*");s.tests.rlsPolicies={status:r&&r.message.includes("policy")?"working":"needs_configuration",responseTime:Date.now()-a,error:r?.message||null}}catch(e){s.tests.rlsPolicies={status:"working",responseTime:Date.now()-a,error:e instanceof Error?e.message:"Unknown error"}}for(let e of(s.tests.environmentVariables={},["NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_SERVICE_ROLE_KEY","UPSTASH_REDIS_URL","UPSTASH_REDIS_TOKEN"])){let t=process.env[e];s.tests.environmentVariables[e]={configured:!!t,value:t?`${t.substring(0,10)}...`:null}}s.tests.errorLog=l.getErrorLog().slice(-10);let u=Date.now()-t,m=[s.tests.basicConnection,...Object.values(s.tests.tableAccess),...Object.values(s.tests.performance),s.tests.concurrentConnections,s.tests.rlsPolicies],p=m.filter(e=>"failed"===e.status).length,g=m.length;return s.summary={totalResponseTime:u,totalTests:g,failedTests:p,successRate:((g-p)/g*100).toFixed(2)+"%",overallStatus:0===p?"healthy":p<3?"degraded":"unhealthy"},i.Z.json(s)}catch(e){return l.createErrorResponse(e,"database test")}}async function m(e){try{let t=await e.json(),{action:s,data:r}=t;switch(s){case"clear_error_log":return l.clearErrorLog(),i.Z.json({status:"success",message:"Error log cleared"});case"test_write_operation":let o=(0,c.e)(),{data:n,error:a}=await o.from("user_settings").insert({user_id:"test-user-"+Date.now(),notifications_enabled:!0}).select().single();if(a)return i.Z.json({status:"failed",error:a.message},{status:400});return i.Z.json({status:"success",message:"Write operation successful",data:n});default:return i.Z.json({status:"error",message:"Invalid action"},{status:400})}}catch(e){return l.createErrorResponse(e,"database test POST")}}let p=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/db-test/route",pathname:"/api/db-test",filename:"route",bundlePath:"app/api/db-test/route"},resolvedPagePath:"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/api/db-test/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:d,headerHooks:h,staticGenerationBailout:w}=p,b="/api/db-test/route";function y(){return(0,a.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:f})}},69978:(e,t,s)=>{"use strict";s.d(t,{e:()=>n});var r=s(74280),o=s(24596);let n=()=>{let e=(0,o.cookies)();return(0,r.createServerClient)("https://bamratexknmqvdbalzen.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhbXJhdGV4a25tcXZkYmFsemVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1MTM4NzEsImV4cCI6MjA2ODA4OTg3MX0.yYa98ioJLLouUgHWITGb7U_VjNCTUuM-5NcraM7f3zA",{cookies:{get:t=>e.get(t)?.value,set(t,s,r){e.set({name:t,value:s,...r})},remove(t,s){e.set({name:t,value:"",...s})}}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3271,8107,6163,782],()=>s(92680));module.exports=r})();