(()=>{var e={};e.id=9477,e.ids=[9477,8181],e.modules={30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},20265:(e,r,t)=>{"use strict";t.r(r),t.d(r,{headerHooks:()=>_,originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var s={};t.r(s),t.d(s,{GET:()=>l});var a=t(10884),u=t(16132),i=t(21040),o=t(95798),n=t(16163);let c=(0,n.createClient)("https://bamratexknmqvdbalzen.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function l(e,{params:r}){try{let t=e.headers.get("authorization");if(!t)return o.Z.json({error:"No authorization header"},{status:401});let s=t.replace("Bearer ",""),{data:{user:a},error:u}=await c.auth.getUser(s);if(u||!a)return o.Z.json({error:"Invalid token"},{status:401});let{data:i,error:n}=await c.from("chats").select("user1_id, user2_id").eq("id",r.chatId).single();if(n||!i)return o.Z.json({error:"Chat not found"},{status:404});let l=i.user1_id===a.id?i.user2_id:i.user1_id,{data:d,error:p}=await c.from("profiles").select("id, full_name, avatar_url, last_seen").eq("id",l).single();if(p||!d)return o.Z.json({error:"User not found"},{status:404});let h=new Date(d.last_seen||0),m=new Date,_=m.getTime()-h.getTime()<3e5,f={id:d.id,full_name:d.full_name,avatar_url:d.avatar_url,is_online:_,last_seen:d.last_seen};return o.Z.json({user:f,mode:"real"})}catch(e){return o.Z.json({error:"Internal server error"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/chat/[chatId]/user/route",pathname:"/api/chat/[chatId]/user",filename:"route",bundlePath:"app/api/chat/[chatId]/user/route"},resolvedPagePath:"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/api/chat/[chatId]/user/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:_,staticGenerationBailout:f}=d,v="/api/chat/[chatId]/user/route";function x(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3271,8107,6163],()=>t(20265));module.exports=s})();