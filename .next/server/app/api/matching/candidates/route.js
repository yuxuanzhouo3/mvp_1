(()=>{var e={};e.id=514,e.ids=[514,8181],e.modules={30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},51137:(e,t,r)=>{"use strict";r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>f,patchFetch:()=>b,requestAsyncStorage:()=>d,routeModule:()=>h,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>_});var i={};r.r(i),r.d(i,{GET:()=>c});var s=r(10884),a=r(16132),n=r(21040),o=r(95798),u=r(16163);let l=(0,u.createClient)("https://bamratexknmqvdbalzen.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function c(e){try{let t="da7bb6ab-1e26-4c3d-b28e-73ece0264b82",{searchParams:r}=new URL(e.url),i=r.get("refresh"),s=parseInt(r.get("limit")||"10"),{data:a,error:n}=await l.from("profiles").select("*").neq("id",t);if(n)return o.Z.json({error:"Failed to fetch profiles"},{status:500});if(!a||0===a.length)return o.Z.json({candidates:[],refresh_token:i||Date.now().toString(),total_found:0,user_id:t,message:"No profiles found for matching"});let{data:u}=await l.from("user_interests").select("user_id, interest").in("user_id",[t,...a.map(e=>e.id)]),c=new Map;u?.forEach(e=>{c.has(e.user_id)||c.set(e.user_id,[]),c.get(e.user_id).push(e.interest)});let h=a.map(e=>{let r=c.get(e.id)||[],i=c.get(t)||[],s=.3;e.age&&e.age>=18&&e.age<=100&&(s+=.1),e.is_online&&(s+=.1),e.is_verified&&(s+=.1),"premium"===e.membership_level&&(s+=.1);let a=r.filter(e=>i.includes(e));return s+=Math.min(.1*a.length,.3),e.location&&(s+=.1),e.bio&&e.bio.length>20&&(s+=.1),s=Math.max(.2,Math.min(1,s))+(Math.random()-.5)*.1,s=Math.max(.2,Math.min(1,s)),{user:{id:e.id,full_name:e.full_name,avatar_url:e.avatar_url,age:e.age,location:e.location,bio:e.bio,interests:r,industry:e.industry,communication_style:e.communication_style,is_online:e.is_online,membership_level:e.membership_level||"free",is_verified:e.is_verified,last_seen:e.last_seen},score:s,reasons:function(e,t){let r=[];return t.length>0&&r.push(`Shared interests: ${t.slice(0,2).join(", ")}`),e.is_online&&r.push("Currently online and active"),e.is_verified&&r.push("Verified profile"),"premium"===e.membership_level&&r.push("Premium member"),e.bio&&e.bio.length>20&&r.push("Detailed profile"),0===r.length&&r.push("AI-powered compatibility match"),r.slice(0,3)}(e,a),compatibility_factors:{interests:a.length/Math.max(r.length,1),personality:.8*Math.random()+.2,location:e.location?.8:.3,industry:.8*Math.random()+.2,communication:.8*Math.random()+.2,activity:e.is_online?.9:.4,values:.8*Math.random()+.2},common_interests:a,match_strength:s>.7?"high":s>.5?"medium":"low",conversation_starters:function(e,t){let r=[];return t.length>0&&r.push(`I see you're interested in ${t[0]}! What got you into that?`),e.bio&&r.push("Your bio caught my attention. I'd love to hear more about your journey!"),e.location&&r.push(`I'm curious about ${e.location}. What's the best thing about living there?`),r.push("What brings you to PersonaLink?"),r.push("I'd love to connect and learn more about you!"),r.slice(0,3)}(e,a)}}),d=h.sort((e,t)=>t.score-e.score);i&&(d=function(e,t){let r=t.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0),i=[...e];for(let e=i.length-1;e>0;e--){let t=Math.abs(r+e)%(e+1);[i[e],i[t]]=[i[t],i[e]]}return i}(d,i));let p=d.slice(0,s);return o.Z.json({candidates:p,refresh_token:i||Date.now().toString(),total_found:p.length,user_id:t,total_available:a.length})}catch(e){return o.Z.json({error:"Internal server error"},{status:500})}}let h=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/matching/candidates/route",pathname:"/api/matching/candidates",filename:"route",bundlePath:"app/api/matching/candidates/route"},resolvedPagePath:"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/api/matching/candidates/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:m,headerHooks:g,staticGenerationBailout:_}=h,f="/api/matching/candidates/route";function b(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[3271,8107,6163],()=>r(51137));module.exports=i})();