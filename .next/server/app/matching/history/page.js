(()=>{var e={};e.id=6390,e.ids=[6390],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},14153:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>d});var r=s(67096),a=s(16132),i=s(37284),l=s.n(i),n=s(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let d=["",{children:["matching",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,77265)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/history/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,62111)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,38196)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,44293)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/not-found.tsx"]}],o=["/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/history/page.tsx"],u="/matching/history/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/matching/history/page",pathname:"/matching/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},45451:(e,t,s)=>{Promise.resolve().then(s.bind(s,41800))},41800:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(53854),a=s(34218),i=s(51018),l=s(86665),n=s(63165),c=s(7857),d=s(26115),o=s(39195),u=s(31974),m=s(2882),x=s(24234),h=s(67510),p=s(76699),f=s(38954),v=s(49425),g=s(75548),y=s.n(g),j=s(24769);function b(){let e=(0,i.useRouter)(),{user:t}=(0,l.a)(),{toast:s}=(0,u.p)(),[g,b]=(0,a.useState)([]),[N,w]=(0,a.useState)([]),[_,k]=(0,a.useState)(""),[q,C]=(0,a.useState)("all"),[S,E]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(!t){e.push("/auth/login");return}Z()},[t]),(0,a.useEffect)(()=>{P()},[g,_,q]);let Z=async()=>{try{E(!0);let e=await fetch("/api/user/matches");if(e.ok){let t=await e.json();b(t.matches)}}catch(e){s({title:"加载失败",description:"无法加载匹配历史",variant:"destructive"})}finally{E(!1)}},P=()=>{let e=g;switch(_&&(e=e.filter(e=>e.matched_user.full_name.toLowerCase().includes(_.toLowerCase())||e.matched_user.location.toLowerCase().includes(_.toLowerCase()))),q){case"active":e=e.filter(e=>"active"===e.status);break;case"inactive":e=e.filter(e=>"inactive"===e.status)}w(e)},z=t=>{e.push(`/chat/${t}`)},L=e=>{let t=new Date(e);return t.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})},G=e=>{switch(e){case"active":return r.jsx(d.C,{variant:"default",className:"bg-green-100 text-green-800",children:"活跃"});case"inactive":return r.jsx(d.C,{variant:"secondary",children:"不活跃"});case"blocked":return r.jsx(d.C,{variant:"destructive",children:"已屏蔽"});default:return r.jsx(d.C,{variant:"outline",children:"未知"})}};return S?r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"加载匹配历史中..."})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"匹配历史"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"查看您的所有匹配记录"})]}),r.jsx(y(),{href:"/dashboard",children:(0,r.jsxs)(c.z,{variant:"outline",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"返回仪表盘"]})})]}),(0,r.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx(x.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(j.I,{placeholder:"搜索匹配...",value:_,onChange:e=>k(e.target.value),className:"pl-10"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(c.z,{variant:"all"===q?"default":"outline",size:"sm",onClick:()=>C("all"),children:["全部 (",g.length,")"]}),(0,r.jsxs)(c.z,{variant:"active"===q?"default":"outline",size:"sm",onClick:()=>C("active"),children:["活跃 (",g.filter(e=>"active"===e.status).length,")"]}),(0,r.jsxs)(c.z,{variant:"inactive"===q?"default":"outline",size:"sm",onClick:()=>C("inactive"),children:["不活跃 (",g.filter(e=>"inactive"===e.status).length,")"]})]})]}),r.jsx("div",{className:"grid gap-4",children:0===N.length?r.jsx(n.Zb,{children:(0,r.jsxs)(n.aY,{className:"text-center py-12",children:[r.jsx(h.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"暂无匹配记录"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:_||"all"!==q?"没有找到符合条件的匹配":"开始匹配来发现新的朋友吧！"}),!_&&"all"===q&&r.jsx(c.z,{onClick:()=>e.push("/matching"),children:"开始匹配"})]})}):N.map(e=>r.jsx(n.Zb,{className:"hover:shadow-md transition-shadow",children:r.jsx(n.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(o.qE,{className:"h-16 w-16",children:[r.jsx(o.F$,{src:e.matched_user.avatar_url}),r.jsx(o.Q5,{children:e.matched_user.full_name.charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.matched_user.full_name}),G(e.status)]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-1"}),e.matched_user.age,"岁"]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(f.Z,{className:"h-4 w-4 mr-1"}),e.matched_user.location]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-4 w-4 mr-1"}),e.compatibility_score,"% 匹配度"]})]}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["匹配于 ",L(e.matched_at),e.last_interaction&&(0,r.jsxs)("span",{className:"ml-4",children:["最后互动: ",L(e.last_interaction)]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"text-right",children:(0,r.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["共 ",e.total_messages," 条消息"]})}),(0,r.jsxs)(c.z,{onClick:()=>z(e.id),disabled:"blocked"===e.status,children:[r.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"聊天"]})]})]})})},e.id))})]})})}},39195:(e,t,s)=>{"use strict";s.d(t,{F$:()=>c,Q5:()=>d,qE:()=>n});var r=s(53854),a=s(34218),i=s(49198),l=s(56370);let n=a.forwardRef(({className:e,...t},s)=>r.jsx(i.fC,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));n.displayName=i.fC.displayName;let c=a.forwardRef(({className:e,...t},s)=>r.jsx(i.Ee,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",e),...t}));c.displayName=i.Ee.displayName;let d=a.forwardRef(({className:e,...t},s)=>r.jsx(i.NY,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));d.displayName=i.NY.displayName},24769:(e,t,s)=>{"use strict";s.d(t,{I:()=>l});var r=s(53854),a=s(34218),i=s(56370);let l=a.forwardRef(({className:e,type:t,label:s,error:a,icon:l,description:n,...c},d)=>(0,r.jsxs)("div",{className:"w-full space-y-1",children:[s&&r.jsx("label",{className:"block text-sm font-medium text-foreground",children:s}),(0,r.jsxs)("div",{className:"relative",children:[l&&r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l}),r.jsx("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background","file:border-0 file:bg-transparent file:text-sm file:font-medium","placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50",l?"pl-10":"",a?"border-destructive focus-visible:ring-destructive/30":"",e),ref:d,...c})]}),n&&!a&&r.jsx("p",{className:"text-xs text-muted-foreground",children:n}),a&&r.jsx("p",{className:"text-xs text-destructive",children:a})]}));l.displayName="Input"},31974:(e,t,s)=>{"use strict";s.d(t,{p:()=>a});var r=s(70664);let a=r.pm},2882:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},76699:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},38954:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},49425:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},24234:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},42380:(e,t,s)=>{"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(34218);"function"==typeof Object.is&&Object.is,r.useState,r.useEffect,r.useLayoutEffect,r.useDebugValue,t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:function(e,t){return t()}},41913:(e,t,s)=>{"use strict";e.exports=s(42380)},77265:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>c});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/matching/history/page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,c=n},49198:(e,t,s)=>{"use strict";s.d(t,{NY:()=>w,Ee:()=>Image,fC:()=>N});var r=s(34218),a=s(65864),i=s(64928),l=s(76223),n=s(59280),c=s(41913);function d(){return()=>{}}var o=s(53854),u="Avatar",[m,x]=(0,a.b)(u),[h,p]=m(u),f=r.forwardRef((e,t)=>{let{__scopeAvatar:s,...a}=e,[i,l]=r.useState("idle");return(0,o.jsx)(h,{scope:s,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:(0,o.jsx)(n.WV.span,{...a,ref:t})})});f.displayName=u;var v="AvatarImage",g=r.forwardRef((e,t)=>{let{__scopeAvatar:s,src:a,onLoadingStatusChange:u=()=>{},...m}=e,x=p(v,s),h=function(e,{referrerPolicy:t,crossOrigin:s}){let a=(0,c.useSyncExternalStore)(d,()=>!0,()=>!1),i=r.useRef(null),n=a?(i.current||(i.current=new window.Image),i.current):null,[o,u]=r.useState(()=>b(n,e));return(0,l.b)(()=>{u(b(n,e))},[n,e]),(0,l.b)(()=>{let e=e=>()=>{u(e)};if(!n)return;let r=e("loaded"),a=e("error");return n.addEventListener("load",r),n.addEventListener("error",a),t&&(n.referrerPolicy=t),"string"==typeof s&&(n.crossOrigin=s),()=>{n.removeEventListener("load",r),n.removeEventListener("error",a)}},[n,s,t]),o}(a,m),f=(0,i.W)(e=>{u(e),x.onImageLoadingStatusChange(e)});return(0,l.b)(()=>{"idle"!==h&&f(h)},[h,f]),"loaded"===h?(0,o.jsx)(n.WV.img,{...m,ref:t,src:a}):null});g.displayName=v;var y="AvatarFallback",j=r.forwardRef((e,t)=>{let{__scopeAvatar:s,delayMs:a,...i}=e,l=p(y,s),[c,d]=r.useState(void 0===a);return r.useEffect(()=>{if(void 0!==a){let e=window.setTimeout(()=>d(!0),a);return()=>window.clearTimeout(e)}},[a]),c&&"loaded"!==l.imageLoadingStatus?(0,o.jsx)(n.WV.span,{...i,ref:t}):null});function b(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}j.displayName=y;var N=f,Image=g,w=j}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3271,7085,7149],()=>s(14153));module.exports=r})();