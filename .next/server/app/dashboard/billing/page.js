(()=>{var e={};e.id=5600,e.ids=[5600],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},96911:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d});var r=t(67096),a=t(16132),i=t(37284),l=t.n(i),n=t(32564),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["dashboard",{children:["billing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,37117)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/billing/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,53683)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,44775)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,38196)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,44293)),"/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/not-found.tsx"]}],o=["/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/billing/page.tsx"],m="/dashboard/billing/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/billing/page",pathname:"/dashboard/billing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},82239:(e,s,t)=>{Promise.resolve().then(t.bind(t,43511))},4578:(e,s,t)=>{Promise.resolve().then(t.bind(t,39195)),Promise.resolve().then(t.t.bind(t,67490,23))},43511:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var r=t(53854),a=t(34218),i=t(51018),l=t(86665),n=t(63165),c=t(7857),d=t(26115),o=t(31974),m=t(2882),x=t(87787),u=t(14024),h=t(85096),p=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,p.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var g=t(75548),f=t.n(g);function j(){let e=(0,i.useRouter)(),{user:s}=(0,l.a)(),{toast:t}=(0,o.p)(),[p,g]=(0,a.useState)([]),[j,y]=(0,a.useState)(!0),[b,N]=(0,a.useState)(0);(0,a.useEffect)(()=>{if(!s){e.push("/auth/login");return}w()},[s]);let w=async()=>{try{y(!0);let e=await fetch("/api/user/billing");if(e.ok){let s=await e.json();g(s.records),N(s.balance||0)}}catch(e){t({title:"加载失败",description:"无法加载账单信息",variant:"destructive"})}finally{y(!1)}},k=()=>{e.push("/payment/recharge")},_=async e=>{try{let s=await fetch(`/api/user/billing/${e}/invoice`);if(s.ok){let t=await s.blob(),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`invoice-${e}.pdf`,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}}catch(e){t({title:"下载失败",description:"无法下载发票",variant:"destructive"})}},Z=e=>{switch(e){case"completed":return r.jsx(d.C,{variant:"default",className:"bg-green-100 text-green-800",children:"已完成"});case"pending":return r.jsx(d.C,{variant:"secondary",children:"处理中"});case"failed":return r.jsx(d.C,{variant:"destructive",children:"失败"});default:return r.jsx(d.C,{variant:"outline",children:"未知"})}},q=e=>{let s=new Date(e);return s.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})};return j?r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"加载账单信息中..."})]})}):r.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"账单管理"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"查看您的充值记录和账单信息"})]}),r.jsx(f(),{href:"/dashboard",children:(0,r.jsxs)(c.z,{variant:"outline",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"返回仪表盘"]})})]}),(0,r.jsxs)(n.Zb,{className:"mb-8",children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center",children:[r.jsx(x.Z,{className:"h-5 w-5 mr-2"}),"当前余额"]})}),r.jsx(n.aY,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["\xa5",b.toFixed(2)]}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"可用于匹配和聊天"})]}),(0,r.jsxs)(c.z,{onClick:k,children:[r.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"充值"]})]})})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-5 w-5 mr-2"}),"充值记录"]})}),r.jsx(n.aY,{children:0===p.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(h.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"暂无充值记录"}),r.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"开始您的第一次充值吧！"}),r.jsx(c.z,{onClick:k,children:"立即充值"})]}):r.jsx("div",{className:"space-y-4",children:p.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(h.Z,{className:"h-8 w-8 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[r.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.description}),Z(e.status)]}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{children:["支付方式: ",e.payment_method]}),(0,r.jsxs)("span",{children:["时间: ",q(e.created_at)]})]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["\xa5",e.amount.toFixed(2)]}),r.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.currency})]}),"completed"===e.status&&e.invoice_url&&(0,r.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>_(e.id),children:[r.jsx(v,{className:"h-4 w-4 mr-2"}),"发票"]})]})]},e.id))})})]})]})})}},39195:(e,s,t)=>{"use strict";t.r(s),t.d(s,{Avatar:()=>n,AvatarFallback:()=>d,AvatarImage:()=>c});var r=t(53854),a=t(34218),i=t(49198),l=t(56370);let n=a.forwardRef(({className:e,...s},t)=>r.jsx(i.fC,{ref:t,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...s}));n.displayName=i.fC.displayName;let c=a.forwardRef(({className:e,...s},t)=>r.jsx(i.Ee,{ref:t,className:(0,l.cn)("aspect-square h-full w-full",e),...s}));c.displayName=i.Ee.displayName;let d=a.forwardRef(({className:e,...s},t)=>r.jsx(i.NY,{ref:t,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...s}));d.displayName=i.NY.displayName},31974:(e,s,t)=>{"use strict";t.d(s,{p:()=>a});var r=t(70664);let a=r.pm},2882:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},85096:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},87787:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},14024:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});var r=t(23708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},37117:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>c});var r=t(95153);let a=(0,r.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/app/dashboard/billing/page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,c=n},53683:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var r=t(4656),a=t(74280),i=t(24596),l=t(41412);async function n(){try{let e=(0,i.cookies)(),s=(0,a.createServerClient)("https://bamratexknmqvdbalzen.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhbXJhdGV4a25tcXZkYmFsemVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1MTM4NzEsImV4cCI6MjA2ODA4OTg3MX0.yYa98ioJLLouUgHWITGb7U_VjNCTUuM-5NcraM7f3zA",{cookies:{get:s=>e.get(s)?.value,set(s,t,r){e.set({name:s,value:t,...r})},remove(s,t){e.set({name:s,value:"",...t})}}}),{data:{user:t},error:r}=await s.auth.getUser();if(r||!t)return null;return t}catch(e){return null}}var c=t(24353),d=t.n(c),o=t(43935),m=t(4850),x=t(95153);let u=(0,x.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/components/ui/avatar.tsx`),{__esModule:h,$$typeof:p}=u;u.default;let v=(0,x.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/components/ui/avatar.tsx#Avatar`),g=(0,x.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/components/ui/avatar.tsx#AvatarImage`),f=(0,x.createProxy)(String.raw`/Users/mac-guest1/Downloads/Git/mvp_projects/mvp_1/components/ui/avatar.tsx#AvatarFallback`);var j=t(95695),y=t(28543),b=t(53111),N=t(34492),w=t(57505),k=t(83515),_=t(19549);let Z=[{name:"Dashboard",href:"/dashboard",icon:j.Z},{name:"Chat",href:"/chat",icon:y.Z},{name:"Matching",href:"/matching",icon:b.Z},{name:"Recharge",href:"/payment/recharge",icon:N.Z},{name:"Settings",href:"/dashboard/settings",icon:w.Z}],q=({user:e})=>{let s=(0,l.usePathname)(),t=async()=>{window.location.href="/auth/login"};return(0,r.jsxs)("div",{className:"flex flex-col w-64 bg-background border-r",children:[r.jsx("div",{className:"flex items-center justify-center h-16 border-b px-4",children:r.jsx("h1",{className:"text-xl font-bold text-primary",children:"PersonaLink"})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[r.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:Z.map(e=>{let t=s===e.href;return(0,r.jsxs)(d(),{href:e.href,className:(0,o.cn)("flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",t?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[r.jsx(e.icon,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})}),(0,r.jsxs)("div",{className:"border-t p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsxs)(v,{className:"h-10 w-10",children:[r.jsx(g,{src:e?.user_metadata?.avatar_url}),r.jsx(f,{children:e?.email?.charAt(0).toUpperCase()||"U"})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:e?.user_metadata?.full_name||e?.email}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:[e?.user_metadata?.credits||0," credits"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(m.z,{variant:"ghost",size:"sm",className:"w-full justify-start",asChild:!0,children:(0,r.jsxs)(d(),{href:"/dashboard/notifications",children:[r.jsx(k.Z,{className:"mr-2 h-4 w-4"}),"Notifications"]})}),(0,r.jsxs)(m.z,{variant:"ghost",size:"sm",className:"w-full justify-start text-destructive hover:text-destructive",onClick:t,children:[r.jsx(_.Z,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]})]})]})};async function C({children:e}){let s=await n();return s||(0,l.redirect)("/auth/login"),(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx(q,{user:s}),r.jsx("main",{className:"flex-1 overflow-y-auto",children:r.jsx("div",{className:"p-6",children:e})})]})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[3271,1945,5649,782,5640,4049],()=>t(96911));module.exports=r})();