(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{7638:function(e,s,t){Promise.resolve().then(t.bind(t,9097))},9097:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return y}});var a=t(7437),r=t(2265),n=t(4033),i=t(4620),l=t(446),c=t(9598),d=t(3611),o=t(1465),u=t(453),h=t(7702),f=t(3067),m=t(2295),x=t(7972),g=t(3021),p=t(9036),v=t(597),j=t(8956);function y(){var e,s,t,y,b;let N=(0,n.useRouter)(),{user:w,signOut:k}=(0,i.a)(),{toast:S}=(0,l.p)(),[C,I]=(0,r.useState)({notifications:{newMatches:!0,messages:!0,weeklyDigest:!1},privacy:{profileVisibility:"public",showOnlineStatus:!0,allowMessages:!0},preferences:{language:"zh-CN",theme:"auto",timezone:"Asia/Shanghai"}}),[_,O]=(0,r.useState)(!1),[T,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=setTimeout(()=>{if(E(!0),!w){N.replace("/auth/login");return}},500);return()=>clearTimeout(e)},[w,N]);let A=async()=>{O(!0);try{await new Promise(e=>setTimeout(e,1e3)),S({title:"设置已保存",description:"您的设置已成功更新"})}catch(e){S({title:"保存失败",description:"无法保存设置，请稍后重试",variant:"destructive"})}finally{O(!1)}},Z=async()=>{try{await k(),N.push("/"),S({title:"已退出登录",description:"期待您的再次光临！"})}catch(e){S({title:"退出失败",description:"请稍后重试",variant:"destructive"})}};return T?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(d.z,{variant:"ghost",size:"sm",onClick:()=>N.back(),className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"返回"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"设置"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"管理您的账户和偏好设置"})]})]}),(0,a.jsxs)(d.z,{onClick:A,disabled:_,children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),_?"保存中...":"保存设置"]})]}),(0,a.jsxs)(c.Zb,{className:"mb-8",children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"个人资料"})]}),(0,a.jsx)(c.SZ,{children:"管理您的个人信息和头像"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(h.qE,{className:"h-16 w-16",children:[(0,a.jsx)(h.F$,{src:null==w?void 0:null===(e=w.user_metadata)||void 0===e?void 0:e.avatar_url}),(0,a.jsx)(h.Q5,{children:(null==w?void 0:null===(t=w.user_metadata)||void 0===t?void 0:null===(s=t.full_name)||void 0===s?void 0:s[0])||(null==w?void 0:null===(y=w.email)||void 0===y?void 0:y[0])||"U"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:(null==w?void 0:null===(b=w.user_metadata)||void 0===b?void 0:b.full_name)||(null==w?void 0:w.email)}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:null==w?void 0:w.email})]}),(0,a.jsx)(d.z,{variant:"outline",children:"编辑资料"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"通知设置"})]}),(0,a.jsx)(c.SZ,{children:"管理您接收的通知类型"})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o._,{htmlFor:"new-matches",children:"新匹配通知"}),(0,a.jsx)(u.r,{id:"new-matches",checked:C.notifications.newMatches,onCheckedChange:e=>I(s=>({...s,notifications:{...s.notifications,newMatches:e}}))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o._,{htmlFor:"messages",children:"消息通知"}),(0,a.jsx)(u.r,{id:"messages",checked:C.notifications.messages,onCheckedChange:e=>I(s=>({...s,notifications:{...s.notifications,messages:e}}))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o._,{htmlFor:"weekly-digest",children:"每周摘要"}),(0,a.jsx)(u.r,{id:"weekly-digest",checked:C.notifications.weeklyDigest,onCheckedChange:e=>I(s=>({...s,notifications:{...s.notifications,weeklyDigest:e}}))})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"隐私设置"})]}),(0,a.jsx)(c.SZ,{children:"控制您的隐私和可见性"})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o._,{htmlFor:"online-status",children:"显示在线状态"}),(0,a.jsx)(u.r,{id:"online-status",checked:C.privacy.showOnlineStatus,onCheckedChange:e=>I(s=>({...s,privacy:{...s.privacy,showOnlineStatus:e}}))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o._,{htmlFor:"allow-messages",children:"允许接收消息"}),(0,a.jsx)(u.r,{id:"allow-messages",checked:C.privacy.allowMessages,onCheckedChange:e=>I(s=>({...s,privacy:{...s.privacy,allowMessages:e}}))})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"偏好设置"})]}),(0,a.jsx)(c.SZ,{children:"自定义您的使用体验"})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"language",children:"语言"}),(0,a.jsxs)("select",{id:"language",value:C.preferences.language,onChange:e=>I(s=>({...s,preferences:{...s.preferences,language:e.target.value}})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700",children:[(0,a.jsx)("option",{value:"zh-CN",children:"中文 (简体)"}),(0,a.jsx)("option",{value:"en-US",children:"English"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"theme",children:"主题"}),(0,a.jsxs)("select",{id:"theme",value:C.preferences.theme,onChange:e=>I(s=>({...s,preferences:{...s.preferences,theme:e.target.value}})),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700",children:[(0,a.jsx)("option",{value:"auto",children:"跟随系统"}),(0,a.jsx)("option",{value:"light",children:"浅色"}),(0,a.jsx)("option",{value:"dark",children:"深色"})]})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"账户管理"})]}),(0,a.jsx)(c.SZ,{children:"管理您的账户设置"})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsx)(d.z,{variant:"outline",className:"w-full",children:"更改密码"}),(0,a.jsx)(d.z,{variant:"outline",className:"w-full",children:"删除账户"}),(0,a.jsx)(d.z,{variant:"destructive",className:"w-full",onClick:Z,children:"退出登录"})]})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-48 animate-pulse"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-32 mb-4 animate-pulse"}),(0,a.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24 animate-pulse"}),(0,a.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-12 animate-pulse"})]},e))})]},e))})]})})})}},4620:function(e,s,t){"use strict";t.d(s,{H:function(){return c},a:function(){return d}});var a=t(7437),r=t(2265),n=t(1492);let i=null,l=(0,r.createContext)(void 0);function c(e){let{children:s}=e,[t,c]=(0,r.useState)(null),[d,o]=(0,r.useState)(null),[u,h]=(0,r.useState)(!0),f=(0,r.useRef)(!1),m=(0,r.useRef)(null),x=function(){if(!i){let e="https://bamratexknmqvdbalzen.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhbXJhdGV4a25tcXZkYmFsemVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1MTM4NzEsImV4cCI6MjA2ODA4OTg3MX0.yYa98ioJLLouUgHWITGb7U_VjNCTUuM-5NcraM7f3zA";if(!e||!s)throw Error("Missing Supabase environment variables");i=(0,n.eI)(e,s,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage}})}return i}();(0,r.useEffect)(()=>{if(f.current)return;f.current=!0;let e=async()=>{try{let{data:{session:e},error:s}=await x.auth.getSession();s||e&&(o(e),c(e.user),m.current=e.user)}catch(e){}finally{h(!1)}};e();let{data:{subscription:s}}=x.auth.onAuthStateChange(async(e,s)=>{h(!0);try{"SIGNED_IN"===e&&s?(o(s),c(s.user),m.current=s.user):"SIGNED_OUT"===e?(o(null),c(null),m.current=null):"TOKEN_REFRESHED"===e&&s?(o(s),c(s.user)):"INITIAL_SESSION"===e&&(s?(o(s),c(s.user),m.current=s.user):(o(null),c(null),m.current=null))}catch(e){}finally{h(!1)}});return()=>{s.unsubscribe()}},[]);let g=(0,r.useCallback)(async(e,s)=>{let{error:t}=await x.auth.signInWithPassword({email:e,password:s});return{error:t}},[]),p=(0,r.useCallback)(async()=>{let{error:e}=await x.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});return{error:e}},[]),v=(0,r.useCallback)(async e=>{let{error:s}=await x.auth.signInWithOtp({phone:e});return{error:s}},[]),j=(0,r.useCallback)(async(e,s)=>{let{error:t}=await x.auth.verifyOtp({phone:e,token:s,type:"sms"});return{error:t}},[]),y=(0,r.useCallback)(async(e,s)=>{let{error:t}=await x.auth.signUp({email:e,password:s});return{error:t}},[]),b=(0,r.useCallback)(async()=>{try{let{error:e}=await x.auth.signOut();if(e)throw e;o(null),c(null),m.current=null,localStorage.removeItem("supabase.auth.token"),localStorage.removeItem("supabase.auth.expires_at"),localStorage.removeItem("supabase.auth.refresh_token")}catch(e){throw e}},[]);return(0,a.jsx)(l.Provider,{value:{user:t,session:d,loading:u,signIn:g,signInWithGoogle:p,signInWithPhone:v,verifyPhoneOTP:j,signUp:y,signOut:b},children:s})}function d(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7702:function(e,s,t){"use strict";t.d(s,{F$:function(){return c},Q5:function(){return d},qE:function(){return l}});var a=t(7437),r=t(2265),n=t(1769),i=t(1628);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.fC,{ref:s,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});l.displayName=n.fC.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.Ee,{ref:s,className:(0,i.cn)("aspect-square h-full w-full",t),...r})});c.displayName=n.Ee.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.NY,{ref:s,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});d.displayName=n.NY.displayName},3611:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var a=t(7437),r=t(2265),n=t(7256),i=t(6061),l=t(1628);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:i,asChild:d=!1,...o}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(c({variant:r,size:i,className:t})),ref:s,...o})});d.displayName="Button"},9598:function(e,s,t){"use strict";t.d(s,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return o},ll:function(){return c}});var a=t(7437),r=t(2265),n=t(1628);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})});u.displayName="CardFooter"},1465:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var a=t(7437),r=t(2265),n=t(6743),i=t(6061),l=t(1628);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.f,{ref:s,className:(0,l.cn)(c(),t),...r})});d.displayName=n.f.displayName},453:function(e,s,t){"use strict";t.d(s,{r:function(){return l}});var a=t(7437),r=t(2265),n=t(2376),i=t(1628);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(n.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform","data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=n.fC.displayName},1271:function(e,s,t){"use strict";t.d(s,{pm:function(){return h}});var a=t(2265);let r=0,n=new Map,i=e=>{if(n.has(e))return;let s=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,s)},l=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?i(t):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],d={toasts:[]};function o(e){d=l(d,e),c.forEach(e=>{e(d)})}function u(e){let{...s}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:t});return o({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function h(){let[e,s]=a.useState(d);return a.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},446:function(e,s,t){"use strict";t.d(s,{p:function(){return r}});var a=t(1271);let r=a.pm},1628:function(e,s,t){"use strict";t.d(s,{cn:function(){return n}});var a=t(7042),r=t(4769);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}}},function(e){e.O(0,[216,744],function(){return e(e.s=7638)}),_N_E=e.O()}]);