"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{4620:function(e,t,a){a.d(t,{H:function(){return c},a:function(){return d}});var r=a(7437),n=a(2265),o=a(1492),s=a(4033);let i=(0,n.createContext)(void 0),u={id:"mock-user-id-123",email:"test@personalink.ai",user_metadata:{full_name:"Test User",avatar_url:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face"},app_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),email_confirmed_at:new Date().toISOString(),last_sign_in_at:new Date().toISOString(),role:"authenticated",identities:[]},l={access_token:"mock-access-token",refresh_token:"mock-refresh-token",expires_in:3600,expires_at:Math.floor(Date.now()/1e3)+3600,token_type:"bearer",user:u};function c(e){let{children:t}=e,[a,c]=(0,n.useState)(null),[d,m]=(0,n.useState)(null),[f,g]=(0,n.useState)(!0),h=(0,s.useRouter)(),p=(0,n.useMemo)(()=>!1,[]),[k,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{try{let e=localStorage.getItem("mock-mode-override");"true"===e&&v(!0)}catch(e){}window.__mockModeLogged||(window.__mockModeLogged=!0)},[p]);let _=p||k,y=(0,n.useMemo)(()=>_?{auth:{getSession:async()=>({data:{session:null},error:null}),signInWithPassword:async()=>({data:{session:null,user:null},error:null}),signUp:async()=>({data:{session:null,user:null},error:null}),signInWithOAuth:async()=>({data:{session:null,user:null},error:null}),signInWithOtp:async()=>({data:{session:null,user:null},error:null}),verifyOtp:async()=>({data:{session:null,user:null},error:null}),signOut:async()=>({error:null}),resetPasswordForEmail:async()=>({data:null,error:null}),updateUser:async()=>({data:{user:null},error:null}),onAuthStateChange:e=>(window.__mockAuthCallback=e,{data:{subscription:{unsubscribe:()=>{delete window.__mockAuthCallback}}}}),functions:{invoke:async()=>({data:null,error:null})}},from:()=>({select:()=>({eq:()=>({single:async()=>({data:null,error:null})})}),upsert:async()=>({data:null,error:null})})}:(0,o.createClient)("https://bamratexknmqvdbalzen.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhbXJhdGV4a25tcXZkYmFsemVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1MTM4NzEsImV4cCI6MjA2ODA4OTg3MX0.yYa98ioJLLouUgHWITGb7U_VjNCTUuM-5NcraM7f3zA"),[p]),b=(0,n.useCallback)(async e=>{if(!_)try{var t,a,r;let{data:n}=await y.from("profiles").select("id").eq("id",e.id).single();if(n)return;let o=await fetch("https://ipapi.co/json/"),s=await o.json();await y.from("profiles").upsert({id:e.id,email:e.email,full_name:(null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null===(a=e.user_metadata)||void 0===a?void 0:a.name),avatar_url:null===(r=e.user_metadata)||void 0===r?void 0:r.avatar_url,updated_at:new Date().toISOString(),device_info:{user_agent:navigator.userAgent,platform:navigator.platform,language:navigator.language},location_info:{ip:s.ip,country:s.country_name,region:s.region,city:s.city,timezone:s.timezone}})}catch(e){}},[y,p]);(0,n.useEffect)(()=>{let e=!0,t=async()=>{try{if(_){let t=null,a=!1;try{t=localStorage.getItem("mock-session"),a=document.cookie.includes("mock-session=true")}catch(e){}if((t||a)&&e){m(l),c(u);return}}else{let{data:{session:t}}=await y.auth.getSession();t&&e&&(m(t),c(t.user))}}catch(e){}};t();let{data:{subscription:a}}=y.auth.onAuthStateChange(async(t,a)=>{var r;e&&(m(a),c(null!==(r=null==a?void 0:a.user)&&void 0!==r?r:null),g(!1),"SIGNED_IN"===t&&(null==a?void 0:a.user)&&setTimeout(()=>{b(a.user)},0))});return()=>{e=!1,a.unsubscribe()}},[y,b,_]);let w=(0,n.useCallback)(async(e,t)=>{if(_)return"test@personalink.ai"===e&&"test123"===t?(m(l),c(u),localStorage.setItem("mock-session","true"),document.cookie="mock-session=true; path=/; max-age=86400; SameSite=Lax",window.__mockAuthCallback&&setTimeout(()=>{window.__mockAuthCallback("SIGNED_IN",l)},100),{error:null}):{error:{message:"Invalid email or password"}};let{error:a}=await y.auth.signInWithPassword({email:e,password:t});return{error:a}},[y,_,a]),S=(0,n.useCallback)(async(e,t,a)=>{if(_){let t={...u,id:"mock-user-".concat(Date.now()),email:e,user_metadata:{full_name:a}};return m({...l,user:t}),c(t),localStorage.setItem("mock-session","true"),document.cookie="mock-session=true; path=/; max-age=86400; SameSite=Lax",{error:null}}let{error:r}=await y.auth.signUp({email:e,password:t,options:{data:{full_name:a}}});return{error:r}},[y,_]),I=(0,n.useCallback)(async()=>{if(_){let e={...u,id:"mock-google-user-".concat(Date.now()),email:"mock-google-user@personalink.ai",user_metadata:{full_name:"Mock Google User",avatar_url:"https://via.placeholder.com/150",provider:"google"}};return m({...l,user:e}),c(e),localStorage.setItem("mock-session","true"),document.cookie="mock-session=true; path=/; max-age=86400; SameSite=Lax",{error:null}}let{error:e}=await y.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});return{error:e}},[y,_]),A=(0,n.useCallback)(async e=>{if(_)return{error:null};let{error:t}=await y.auth.signInWithOtp({phone:e});return{error:t}},[y,_]),T=(0,n.useCallback)(async(e,t)=>{if(_){if(!(6===t.length&&/^\d+$/.test(t)))return{error:{message:"Please enter a valid 6-digit code"}};{let t={...u,id:"mock-phone-user-".concat(Date.now()),email:"".concat(e,"@personalink.ai"),phone:e,user_metadata:{full_name:"Mock Phone User",phone:e}};return m({...l,user:t}),c(t),localStorage.setItem("mock-session","true"),document.cookie="mock-session=true; path=/; max-age=86400; SameSite=Lax",{error:null}}}let{error:a}=await y.auth.verifyOtp({phone:e,token:t,type:"sms"});return{error:a}},[y,_]),O=(0,n.useCallback)(async()=>{if(_){m(null),c(null),localStorage.removeItem("mock-session"),document.cookie="mock-session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",window.__mockAuthCallback&&setTimeout(()=>{window.__mockAuthCallback("SIGNED_OUT",null)},100),h.push("/");return}await y.auth.signOut(),h.push("/")},[y,h,_]),C=(0,n.useCallback)(async e=>{if(_)return{error:{message:"Password reset not available in mock mode"}};let{error:t}=await y.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/update-password")});return{error:t}},[y,_]),x=(0,n.useCallback)(async e=>{if(_)return{error:{message:"Password update not available in mock mode"}};let{error:t}=await y.auth.updateUser({password:e});return{error:t}},[y,_]),E=(0,n.useCallback)(async()=>{if(_)return{error:{message:"2FA not available in mock mode"}};try{let{data:e,error:t}=await y.functions.invoke("enable-2fa",{body:{userId:null==a?void 0:a.id}});return{error:t,data:e}}catch(e){return{error:{message:"Failed to enable 2FA"}}}},[y,a,_]),M=(0,n.useCallback)(async e=>{if(_)return{error:{message:"2FA verification not available in mock mode"}};try{let{data:t,error:r}=await y.functions.invoke("verify-2fa",{body:{userId:null==a?void 0:a.id,token:e}});return{error:r,data:t}}catch(e){return{error:{message:"Failed to verify 2FA"}}}},[y,a,_]),D=(0,n.useMemo)(()=>({user:a,session:d,loading:f,signIn:w,signUp:S,signInWithGoogle:I,signInWithPhone:A,verifyPhoneOTP:T,signOut:O,resetPassword:C,updatePassword:x,enable2FA:E,verify2FA:M,supabase:y}),[a,d,f,w,S,I,A,T,O,C,x,E,M,y]);return(0,r.jsx)(i.Provider,{value:D,children:t})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3611:function(e,t,a){a.d(t,{z:function(){return l}});var r=a(7437),n=a(2265),o=a(7256),s=a(6061),i=a(1628);let u=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:a,variant:n,size:s,asChild:l=!1,...c}=e,d=l?o.g7:"button";return(0,r.jsx)(d,{className:(0,i.cn)(u({variant:n,size:s,className:a})),ref:t,...c})});l.displayName="Button"},1271:function(e,t,a){a.d(t,{pm:function(){return m}});var r=a(2265);let n=0,o=new Map,s=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?s(a):e.toasts.forEach(e=>{s(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},u=[],l={toasts:[]};function c(e){l=i(l,e),u.forEach(e=>{e(l)})}function d(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(l);return r.useEffect(()=>(u.push(t),()=>{let e=u.indexOf(t);e>-1&&u.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},1628:function(e,t,a){a.d(t,{cn:function(){return o}});var r=a(7042),n=a(4769);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}}}]);